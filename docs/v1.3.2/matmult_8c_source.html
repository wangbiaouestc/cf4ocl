<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>cf4ocl (C Framework for OpenCL): examples/matmult.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cf4ocl (C Framework for OpenCL)
   </div>
   <div id="projectbrief">Utilities and libraries for developing and benchmarking OpenCL projects in the C programming language.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e931c1a3f0014e624d0645a271726ad2.html">examples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">matmult.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="matmult_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*   </span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * This file is part of cf4ocl (C Framework for OpenCL).</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * cf4ocl is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * cf4ocl is distributed in the hope that it will be useful, </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * along with cf4ocl.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="matmult_8h.html">matmult.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="matmult_8c.html#a1579df3a428a5aff80e5a1e0cfa2f713">   50</a></span>&#160;<span class="preprocessor">#define A_COLS 128</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="matmult_8c.html#a3846838d5614130293f878591d9417c7">   52</a></span>&#160;<span class="preprocessor">#define A_ROWS 256</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="matmult_8c.html#aa6c7005b99ec05adc2cfac1060e1e644">   54</a></span>&#160;<span class="preprocessor">#define B_COLS 16</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="matmult_8c.html#a9ad4d76b2a845d89ee2ce6198fb488d8">   56</a></span>&#160;<span class="preprocessor">#define B_ROWS A_COLS</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="matmult_8c.html#a769c881bc0b0d7b78ec45b52ed7133ae">   59</a></span>&#160;<span class="preprocessor">#define LWS_X 32</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="matmult_8c.html#af9a15eccf5ca0133aa49ae35bc2e2f10">   61</a></span>&#160;<span class="preprocessor">#define LWS_Y 16</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="matmult_8c.html#a7efcfabdd53cca51786b2616ec65e598">   64</a></span>&#160;<span class="preprocessor">#define RANGE_MATRIX_FROM -100</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="matmult_8c.html#a9ca5c73118893390a779a2342c29da3a">   67</a></span>&#160;<span class="preprocessor">#define RANGE_MATRIX_TO 100</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="matmult_8c.html#ab53adb106bfbfc72bc0918855fccdb18">   70</a></span>&#160;<span class="preprocessor">#define KERNEL_ID 0 </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="matmult_8c.html#a42f8c497a1968074f38bf5055c650dca">   73</a></span>&#160;<span class="preprocessor">#define VERBOSE FALSE</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="matmult_8c.html#ad350bae49f72ba58d73027f1316e38b8">   76</a></span>&#160;<span class="preprocessor">#define SEED 0</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="matmult_8c.html#a0159a7996b02aca4b98b3bbbca901f88">   79</a></span>&#160;<span class="preprocessor">#define PROG_DESCRIPTION &quot;Program for testing matrix multiplication on a OpenCL device (GPU or CPU, although optimized for the former) and compare with OpenMP implementation on the CPU.&quot;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/* Command line arguments and respective default values. */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> a_dim[] = {<a class="code" href="matmult_8c.html#a1579df3a428a5aff80e5a1e0cfa2f713">A_COLS</a>, <a class="code" href="matmult_8c.html#a3846838d5614130293f878591d9417c7">A_ROWS</a>};</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> b_dim[] = {<a class="code" href="matmult_8c.html#aa6c7005b99ec05adc2cfac1060e1e644">B_COLS</a>, <a class="code" href="matmult_8c.html#a9ad4d76b2a845d89ee2ce6198fb488d8">B_ROWS</a>};</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> lws[] = {<a class="code" href="matmult_8c.html#a769c881bc0b0d7b78ec45b52ed7133ae">LWS_X</a>, <a class="code" href="matmult_8c.html#af9a15eccf5ca0133aa49ae35bc2e2f10">LWS_Y</a>};</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> matrix_range[] = {<a class="code" href="matmult_8c.html#a7efcfabdd53cca51786b2616ec65e598">RANGE_MATRIX_FROM</a>, <a class="code" href="matmult_8c.html#a9ca5c73118893390a779a2342c29da3a">RANGE_MATRIX_TO</a>};</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">static</span> gchar* compiler_opts = NULL;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> dev_idx = -1;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">static</span> gchar* dev_name = NULL;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keyword">static</span> gchar* dev_vendor = NULL;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">static</span> gchar* platf_name = NULL;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> kernel_id = <a class="code" href="matmult_8c.html#ab53adb106bfbfc72bc0918855fccdb18">KERNEL_ID</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keyword">static</span> gboolean verbose = <a class="code" href="matmult_8c.html#a42f8c497a1968074f38bf5055c650dca">VERBOSE</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">static</span> guint32 seed = <a class="code" href="matmult_8c.html#ad350bae49f72ba58d73027f1316e38b8">SEED</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keyword">static</span> gchar* output_export = NULL;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">/* Callback functions to parse pairs of numbers. */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">static</span> gboolean mm_parse_a(<span class="keyword">const</span> gchar *option_name, <span class="keyword">const</span> gchar *value, gpointer data, GError **err) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="exp__common_8h.html#ab10604e3bc9e1b49bbf831eb4bab6910">clexp_parse_pairs</a>(value, a_dim, option_name, data, err);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">static</span> gboolean mm_parse_b(<span class="keyword">const</span> gchar *option_name, <span class="keyword">const</span> gchar *value, gpointer data, GError **err) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="exp__common_8h.html#ab10604e3bc9e1b49bbf831eb4bab6910">clexp_parse_pairs</a>(value, b_dim, option_name, data, err);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">static</span> gboolean mm_parse_lws(<span class="keyword">const</span> gchar *option_name, <span class="keyword">const</span> gchar *value, gpointer data, GError **err) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="exp__common_8h.html#ab10604e3bc9e1b49bbf831eb4bab6910">clexp_parse_pairs</a>(value, lws, option_name, data, err);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">static</span> gboolean mm_parse_rge(<span class="keyword">const</span> gchar *option_name, <span class="keyword">const</span> gchar *value, gpointer data, GError **err) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="exp__common_8h.html#ab10604e3bc9e1b49bbf831eb4bab6910">clexp_parse_pairs</a>(value, matrix_range, option_name, data, err);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">/* Valid command line options. */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">static</span> GOptionEntry entries[] = {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        {<span class="stringliteral">&quot;kernel&quot;</span>,    <span class="charliteral">&#39;k&#39;</span>, 0, G_OPTION_ARG_INT,      &amp;kernel_id,     <span class="stringliteral">&quot;kernel selection: 0-2 (C=AB), 3-4 (C=AA^T) (default is &quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#ab53adb106bfbfc72bc0918855fccdb18">KERNEL_ID</a>) <span class="stringliteral">&quot;)&quot;</span>,             <span class="stringliteral">&quot;ID&quot;</span>},</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        {<span class="stringliteral">&quot;asize&quot;</span>,     <span class="charliteral">&#39;a&#39;</span>, 0, G_OPTION_ARG_CALLBACK, mm_parse_a,     <span class="stringliteral">&quot;Size (cols,rows) of matrix A (default is &quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#a1579df3a428a5aff80e5a1e0cfa2f713">A_COLS</a>) <span class="stringliteral">&quot;,&quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#a3846838d5614130293f878591d9417c7">A_ROWS</a>) <span class="stringliteral">&quot;)&quot;</span>,              <span class="stringliteral">&quot;SIZE,SIZE&quot;</span>},</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        {<span class="stringliteral">&quot;bsize&quot;</span>,     <span class="charliteral">&#39;b&#39;</span>, 0, G_OPTION_ARG_CALLBACK, mm_parse_b,     <span class="stringliteral">&quot;Size (cols,rows) of matrix B (default is &quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#aa6c7005b99ec05adc2cfac1060e1e644">B_COLS</a>) <span class="stringliteral">&quot;,&quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#a9ad4d76b2a845d89ee2ce6198fb488d8">B_ROWS</a>) <span class="stringliteral">&quot;)&quot;</span>,              <span class="stringliteral">&quot;SIZE,SIZE&quot;</span>},</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        {<span class="stringliteral">&quot;localsize&quot;</span>, <span class="charliteral">&#39;l&#39;</span>, 0, G_OPTION_ARG_CALLBACK, mm_parse_lws,   <span class="stringliteral">&quot;Local work size (default is &quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#a769c881bc0b0d7b78ec45b52ed7133ae">LWS_X</a>) <span class="stringliteral">&quot;,&quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#af9a15eccf5ca0133aa49ae35bc2e2f10">LWS_Y</a>) <span class="stringliteral">&quot;)&quot;</span>,                             <span class="stringliteral">&quot;SIZE,SIZE&quot;</span>},</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        {<span class="stringliteral">&quot;range&quot;</span>,     <span class="charliteral">&#39;r&#39;</span>, 0, G_OPTION_ARG_CALLBACK, mm_parse_rge,   <span class="stringliteral">&quot;Matrix range of values (default is &quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#a7efcfabdd53cca51786b2616ec65e598">RANGE_MATRIX_FROM</a>) <span class="stringliteral">&quot;,&quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#a9ca5c73118893390a779a2342c29da3a">RANGE_MATRIX_TO</a>)<span class="stringliteral">&quot;)&quot;</span>, <span class="stringliteral">&quot;MIN,MAX&quot;</span>},</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        {<span class="stringliteral">&quot;seed&quot;</span>,      <span class="charliteral">&#39;s&#39;</span>, 0, G_OPTION_ARG_INT,      &amp;seed,          <span class="stringliteral">&quot;RNG seed (default is &quot;</span> <a class="code" href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a>(<a class="code" href="matmult_8c.html#ad350bae49f72ba58d73027f1316e38b8">SEED</a>)<span class="stringliteral">&quot;)&quot;</span>,                                                     <span class="stringliteral">&quot;SEED&quot;</span>},</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        {<span class="stringliteral">&quot;verbose&quot;</span>,   <span class="charliteral">&#39;v&#39;</span>, 0, G_OPTION_ARG_NONE,     &amp;verbose,       <span class="stringliteral">&quot;Print input and output matrices to stderr&quot;</span>,                                              NULL},</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        {<span class="stringliteral">&quot;device&quot;</span>,    <span class="charliteral">&#39;d&#39;</span>, 0, G_OPTION_ARG_INT,      &amp;dev_idx,       <span class="stringliteral">&quot;Device index, auto-selects device from menu (takes priority on -n and -p options)&quot;</span>,      <span class="stringliteral">&quot;INDEX&quot;</span>},</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        {<span class="stringliteral">&quot;dname&quot;</span>,     <span class="charliteral">&#39;n&#39;</span>, 0, G_OPTION_ARG_STRING,   &amp;dev_name,      <span class="stringliteral">&quot;Device name, selects device by name&quot;</span>,                                                    <span class="stringliteral">&quot;NAME&quot;</span>},</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        {<span class="stringliteral">&quot;dvendor&quot;</span>,   <span class="charliteral">&#39;e&#39;</span>, 0, G_OPTION_ARG_STRING,   &amp;dev_vendor,    <span class="stringliteral">&quot;Device vendor, selects device by vendor&quot;</span>,                                                <span class="stringliteral">&quot;VENDOR&quot;</span>},</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        {<span class="stringliteral">&quot;dplatf&quot;</span>,    <span class="charliteral">&#39;p&#39;</span>, 0, G_OPTION_ARG_STRING,   &amp;platf_name,    <span class="stringliteral">&quot;Platform name, selects device by platform name&quot;</span>,                                         <span class="stringliteral">&quot;NAME&quot;</span>},</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        {<span class="stringliteral">&quot;compiler&quot;</span>,  <span class="charliteral">&#39;c&#39;</span>, 0, G_OPTION_ARG_STRING,   &amp;compiler_opts, <span class="stringliteral">&quot;Extra OpenCL compiler options&quot;</span>,                                                          <span class="stringliteral">&quot;OPTS&quot;</span>},</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        {<span class="stringliteral">&quot;output&quot;</span>,    <span class="charliteral">&#39;o&#39;</span>, 0, G_OPTION_ARG_FILENAME, &amp;output_export, <span class="stringliteral">&quot;File where to export profiling info (default is none)&quot;</span>,                                  <span class="stringliteral">&quot;FILE&quot;</span>},</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        { NULL, 0, 0, 0, NULL, NULL, NULL }     </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;};</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">/* Kernel file. */</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span>* kernelFiles[] = {<span class="stringliteral">&quot;matmult.cl&quot;</span>};</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="matmult_8c.html#a0ddf1224851353fc92bfbff6f499fa97">  139</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="matmult_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">/* ************* */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">/* Program vars. */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">/* ************* */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordtype">int</span> status;                                    <span class="comment">/* Function and program return status. */</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="structclu__device__info.html">CLUDeviceInfo</a> deviceInfo;                      <span class="comment">/* Select device by returned information strings. */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        GError *err = NULL;                            <span class="comment">/* Error management */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        GRand* rng = NULL;                                 <span class="comment">/* Random number generator. */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="structprofcl__profile.html">ProfCLProfile</a> *profile_dev = NULL,             <span class="comment">/* Profiler for OpenCL device implementation */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                *profile_cpu = NULL;                       <span class="comment">/* Profiler for OpenMP CPU implementation */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="structclu__zone.html">CLUZone</a>* zone = NULL;                          <span class="comment">/* OpenCL zone (context, platform, program, queues, etc.) */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="structcl_event.html">cl_event</a> events[4] = {NULL, NULL, NULL, NULL}; <span class="comment">/* OpenCL events */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        cl_kernel kernel_matmult = NULL;               <span class="comment">/* Kernel object */</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        gchar* kernelName = NULL;                      <span class="comment">/* Kernel name */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        gchar* kernelPath = NULL;                      <span class="comment">/* Full kernel path. */</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a">cl_int</a> *matrixA_host = NULL,                   <span class="comment">/* Host matrix A */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                *matrixB_host = NULL,                      <span class="comment">/* Host matrix B */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                *matrixC_host = NULL;                      <span class="comment">/* Host matrix C (calcutated on OpenCL device). */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordtype">int</span> *matrixC_test = NULL;                      <span class="comment">/* Host matrix C (calculated on the CPU). */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        cl_mem matrixA_device = NULL,                  <span class="comment">/* Device matrix A. */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                matrixB_device = NULL,                     <span class="comment">/* Device matrix B. */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                matrixC_device = NULL;                     <span class="comment">/* Device matrix C. */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordtype">size_t</span> gws[2];                                 <span class="comment">/* Global work sizes */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">size_t</span> sizeMatrixAInBytes = 0,                 <span class="comment">/* Size of matrix A in bytes. */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                sizeMatrixBInBytes = 0,                    <span class="comment">/* Size of matrix B in bytes. */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                sizeMatrixCInBytes = 0;                    <span class="comment">/* Size of matrix C in bytes. */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordtype">size_t</span> globalMemSizeInBytes,                   <span class="comment">/* Size of device global memory required. */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                localMemSizeAInBytes,                      <span class="comment">/* Size of local memory required by matrix A (depends on kernel id). */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                localMemSizeBInBytes;                      <span class="comment">/* Size of local memory required by matrix B (depends on kernel id). */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">/* ************************** */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">/* Parse command line options */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">/* ************************** */</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="matmult_8c.html#abdcd498e039367132145f428df93f2eb">matmult_args_parse</a>(argc, argv, &amp;err);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">/* ******************************************************* */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">/* Initialize profiler, OpenCL variables and build program */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">/* ******************************************************* */</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">/* Initialize RNG. */</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        rng = g_rand_new_with_seed(seed);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">/* Profiling / Timmings */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        profile_dev = <a class="code" href="clprofiler_8c.html#ab1b31625c65ec819cf1e092da13c9cc0">profcl_profile_new</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                err, </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                profile_dev == NULL, </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                error_handler, </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="stringliteral">&quot;Unable to create device profiler object.&quot;</span>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        profile_cpu = <a class="code" href="clprofiler_8c.html#ab1b31625c65ec819cf1e092da13c9cc0">profcl_profile_new</a>();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                err, </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                profile_cpu == NULL, </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                error_handler, </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="stringliteral">&quot;Unable to create CPU profiler object.&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">/* Get the required CL zone. */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> ((dev_idx != -1) || ((dev_name == NULL) &amp;&amp; (platf_name ==NULL))) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="comment">/* Select device by index or user choice. */</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                zone = <a class="code" href="clutils_8c.html#aafef46ba2df88c456ba056b4806ef51e">clu_zone_new</a>(</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                        CL_DEVICE_TYPE_ALL, </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        1, </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        CL_QUEUE_PROFILING_ENABLE, </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                        <a class="code" href="clutils_8c.html#af96c5c98deef8a8cdde6f7efbc610767">clu_menu_device_selector</a>, </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        (dev_idx != -1 ? &amp;dev_idx : NULL), </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                        &amp;err);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="comment">/* Select device by device name and/or platform name. */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keywordflow">if</span> (dev_name != NULL) </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                        g_strlcpy(deviceInfo.<a class="code" href="structclu__device__info.html#a177c7a0eb96a3bc2416f3b09a881eb97">device_name</a>, dev_name, <a class="code" href="group___c_l_u___m_a_x.html#gac3230980b5f2628f08ee53c8f45726a0">CLU_MAX_AUX_BUFF</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                        deviceInfo.<a class="code" href="structclu__device__info.html#a177c7a0eb96a3bc2416f3b09a881eb97">device_name</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keywordflow">if</span> (dev_vendor != NULL) </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                        g_strlcpy(deviceInfo.<a class="code" href="structclu__device__info.html#a4731711f2f64ffd4f71f81024087b719">device_vendor</a>, dev_vendor, <a class="code" href="group___c_l_u___m_a_x.html#gac3230980b5f2628f08ee53c8f45726a0">CLU_MAX_AUX_BUFF</a>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                        deviceInfo.<a class="code" href="structclu__device__info.html#a4731711f2f64ffd4f71f81024087b719">device_vendor</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="keywordflow">if</span> (platf_name != NULL) </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                        g_strlcpy(deviceInfo.<a class="code" href="structclu__device__info.html#a8d5741b6e1df3ba5b9b37d214d5d9720">platform_name</a>, platf_name, <a class="code" href="group___c_l_u___m_a_x.html#gac3230980b5f2628f08ee53c8f45726a0">CLU_MAX_AUX_BUFF</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                        deviceInfo.<a class="code" href="structclu__device__info.html#a8d5741b6e1df3ba5b9b37d214d5d9720">platform_name</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                zone = <a class="code" href="clutils_8c.html#aafef46ba2df88c456ba056b4806ef51e">clu_zone_new</a>(</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                        CL_DEVICE_TYPE_ALL, </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                        1, </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                        CL_QUEUE_PROFILING_ENABLE, </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                        <a class="code" href="clutils_8c.html#a6ff17fcd1045d12e94f023ac8af1a406">clu_info_device_selector</a>, </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                        &amp;deviceInfo, </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                        &amp;err);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        printf(<span class="stringliteral">&quot;\n   == Using device &#39;%s&#39; from &#39;%s&#39; (platform is &#39;%s&#39;)\n&quot;</span>, </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                zone-&gt;<a class="code" href="structclu__zone.html#a4406e6a8de34678827c0891ef4a3e4db">device_info</a>.<a class="code" href="structclu__device__info.html#a177c7a0eb96a3bc2416f3b09a881eb97">device_name</a>, </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                zone-&gt;<a class="code" href="structclu__zone.html#a4406e6a8de34678827c0891ef4a3e4db">device_info</a>.<a class="code" href="structclu__device__info.html#a4731711f2f64ffd4f71f81024087b719">device_vendor</a>, </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                zone-&gt;<a class="code" href="structclu__zone.html#a4406e6a8de34678827c0891ef4a3e4db">device_info</a>.<a class="code" href="structclu__device__info.html#a8d5741b6e1df3ba5b9b37d214d5d9720">platform_name</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment">/* Get location of kernel file, which should be in the same location </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">         * has the matmult executable. */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        kernelPath = <a class="code" href="exp__common_8c.html#a154ee0dfbead43776b8cc5ccecd49917">clexp_kernelpath_get</a>(kernelFiles[0], argv[0]);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="comment">/* Build program. */</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        status = <a class="code" href="clutils_8c.html#a321d53c508616c0e432488bcdb78b6cf">clu_program_create</a>(zone, &amp;kernelPath, 1, compiler_opts, &amp;err);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="comment">/* Kernel */</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        kernelName = g_strdup_printf(<span class="stringliteral">&quot;matmult%d&quot;</span>, kernel_id);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        kernel_matmult = clCreateKernel(zone-&gt;<a class="code" href="structclu__zone.html#a22ecfe977ebfe190a5da0a060d5fc4ef">program</a>, kernelName, &amp;status);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                err, </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a> != status, </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, error_handler, </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="stringliteral">&quot;Unable to create &#39;%s&#39; kernel (OpenCL error %d: %s)&quot;</span>, </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                kernelName,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                status,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment">/* ********************************** */</span>        </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="comment">/* Create and initialize host buffers */</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">/* ********************************** */</span>        </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">/* Matrix A */</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        sizeMatrixAInBytes = a_dim[0] * a_dim[1] * <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a">cl_int</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        matrixA_host = <a class="code" href="matmult_8c.html#adee8bac384bb7760949f394ce508f88b">matmult_matrix_new</a>(a_dim[0], a_dim[1], matrix_range, rng);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                err, </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                matrixA_host == NULL, </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                error_handler, </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="stringliteral">&quot;Unable to create host matrix A.&quot;</span>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">/* Matrix B */</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="matmult_8h.html#abd146d2fd1dc4d9a55cb5304590addcd">IS_AAT</a>(kernel_id)) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                <span class="comment">/* Only required if we&#39;re not multiplying the transpose. */</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                sizeMatrixBInBytes = b_dim[0] * b_dim[1] * <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a">cl_int</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                matrixB_host = <a class="code" href="matmult_8c.html#adee8bac384bb7760949f394ce508f88b">matmult_matrix_new</a>(b_dim[0], b_dim[1], matrix_range, rng);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                        err, </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        matrixB_host == NULL, </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        <span class="stringliteral">&quot;Unable to create host matrix B.&quot;</span>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">/* Matrix C (result) */</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        sizeMatrixCInBytes = b_dim[0] * a_dim[1] * <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a">cl_int</a>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        matrixC_host = <a class="code" href="matmult_8c.html#adee8bac384bb7760949f394ce508f88b">matmult_matrix_new</a>(b_dim[0], a_dim[1], NULL, NULL);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                err, </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                matrixC_host == NULL, </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                error_handler, </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="stringliteral">&quot;Unable to create host matrix C.&quot;</span>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">/* ********************* */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">/* Create device buffers */</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="comment">/* ********************* */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="comment">/* Matrix A */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        matrixA_device = clCreateBuffer(</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                zone-&gt;<a class="code" href="structclu__zone.html#a7afda8b03e51380bc7cdb908a95ae73a">context</a>, </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                CL_MEM_READ_ONLY, </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                sizeMatrixAInBytes, </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                NULL, </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                &amp;status);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                err, </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                error_handler, </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <span class="stringliteral">&quot;Unable to create device buffer for matrix A (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                status,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">/* Matrix B */</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="matmult_8h.html#abd146d2fd1dc4d9a55cb5304590addcd">IS_AAT</a>(kernel_id)) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="comment">/* Only required if we&#39;re not multiplying the transpose. */</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                matrixB_device = clCreateBuffer(</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                        zone-&gt;<a class="code" href="structclu__zone.html#a7afda8b03e51380bc7cdb908a95ae73a">context</a>, </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                        CL_MEM_READ_ONLY, </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                        sizeMatrixBInBytes, </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        NULL, </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        &amp;status);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        err, </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                        status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        <span class="stringliteral">&quot;Unable to create device buffer for matrix B (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        status,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">/* Matrix C */</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        matrixC_device = clCreateBuffer(</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                zone-&gt;<a class="code" href="structclu__zone.html#a7afda8b03e51380bc7cdb908a95ae73a">context</a>, </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                CL_MEM_WRITE_ONLY, </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                sizeMatrixCInBytes, </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                NULL, </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                &amp;status);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                err, </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                error_handler, </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="stringliteral">&quot;Unable to create device buffer for matrix C (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                status,</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">/* ************************* */</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">/* Initialize device buffers */</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">/* ************************* */</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">/* Start basic timming / profiling. */</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="clprofiler_8c.html#abd2e222ebad6d1ce9015c820a5b7016d">profcl_profile_start</a>(profile_dev);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="comment">/* Copy matrix A to device. */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        status = clEnqueueWriteBuffer ( </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                zone-&gt;<a class="code" href="structclu__zone.html#a56783e9302d069f06e18bcfcdd0380fc">queues</a>[0], </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                matrixA_device, </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                CL_TRUE, </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                0, </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                sizeMatrixAInBytes, </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                matrixA_host, </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                0, </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                NULL, </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                &amp;(events[0]) </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        );</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                err, </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                error_handler, </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <span class="stringliteral">&quot;Unable to write matrix A on device (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                status,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">/* Copy matrix B to device. */</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="matmult_8h.html#abd146d2fd1dc4d9a55cb5304590addcd">IS_AAT</a>(kernel_id)) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="comment">/* Only required if we&#39;re not multiplying the transpose. */</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                status = clEnqueueWriteBuffer ( </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        zone-&gt;<a class="code" href="structclu__zone.html#a56783e9302d069f06e18bcfcdd0380fc">queues</a>[0], </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        matrixB_device, </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        CL_TRUE, </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        0, </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        sizeMatrixBInBytes, </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        matrixB_host, </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                        0, </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        NULL, </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        &amp;(events[1]) </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                );</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        err, </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        <span class="stringliteral">&quot;Unable to write matrix B on device (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        status,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment">/* ******************** */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">/*  Determine worksizes */</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="comment">/* ******************** */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        gws[0] = lws[0]* ceil(((<span class="keywordtype">float</span>) b_dim[0]) / lws[0]);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        gws[1] = lws[1] * ceil(((<span class="keywordtype">float</span>) a_dim[1]) / lws[1]);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">/* ************************* */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="comment">/* Determine required memory */</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment">/* ************************* */</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="comment">/* Global memory requirements. */</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        globalMemSizeInBytes = </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                sizeMatrixAInBytes + sizeMatrixBInBytes + sizeMatrixCInBytes;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">/* Local memory requirements. Default is 0 for non-optimized kernels 0 and 3. */</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        localMemSizeAInBytes = 0;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        localMemSizeBInBytes = 0;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">if</span> (kernel_id &gt;= 1)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="comment">/* Optimized matrix mult. 1*/</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                localMemSizeAInBytes = a_dim[0] * lws[1] * <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a">cl_int</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">if</span> (kernel_id == 2)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="comment">/* Optimized matrix mult. 2*/</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                localMemSizeBInBytes = lws[0] * b_dim[1] * <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a">cl_int</a>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">if</span> (kernel_id == 4) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="comment">/* Optimized matrix transpose mult. */</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                localMemSizeAInBytes = lws[1] * a_dim[0] * <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a">cl_int</a>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                localMemSizeBInBytes = lws[0] * a_dim[0] * <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a">cl_int</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">/* ****************************** */</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">/* Print requirements information */</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">/* ****************************** */</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <a class="code" href="exp__common_8c.html#a425368c6a70a29de8cdfac4fd8737160">clexp_reqs_print</a>(gws, lws, globalMemSizeInBytes, </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                localMemSizeAInBytes + localMemSizeBInBytes);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">/* *************************** */</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">/*  Set fixed kernel arguments */</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="comment">/* *************************** */</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">/* Generic arguments */</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        status = clSetKernelArg(</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                kernel_matmult, 0, <span class="keyword">sizeof</span>(cl_mem), (<span class="keywordtype">void</span> *) &amp;matrixA_device);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                err, </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                error_handler, </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="stringliteral">&quot;Unable set arg 0 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                kernelName,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                status,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="matmult_8h.html#abd146d2fd1dc4d9a55cb5304590addcd">IS_AAT</a>(kernel_id)) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="comment">/* Arguments only for C=AB */</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                status = clSetKernelArg(</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                        kernel_matmult, 1, <span class="keyword">sizeof</span>(cl_mem), (<span class="keywordtype">void</span> *) &amp;matrixB_device);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        err, </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                        status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        <span class="stringliteral">&quot;Unable set arg 1 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        kernelName, </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                        status,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                status = clSetKernelArg(</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                        kernel_matmult, 2, <span class="keyword">sizeof</span>(cl_mem), (<span class="keywordtype">void</span> *) &amp;matrixC_device);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                        err, </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        <span class="stringliteral">&quot;Unable set arg 2 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                        kernelName, </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                        status,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                        <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                status = clSetKernelArg(</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                        kernel_matmult, 3, <span class="keyword">sizeof</span>(cl_int2), (<span class="keywordtype">void</span> *) &amp;a_dim);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                        err, </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                        status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                        <span class="stringliteral">&quot;Unable set arg 3 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        kernelName,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                        status, </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                        <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                status = clSetKernelArg(</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        kernel_matmult, 4, <span class="keyword">sizeof</span>(cl_int2), (<span class="keywordtype">void</span> *) &amp;b_dim);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                        err, </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        <span class="stringliteral">&quot;Unable set arg 4 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>,</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                        kernelName,</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        status,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                        <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="keywordflow">if</span> (kernel_id &gt;= 1) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        status = clSetKernelArg(</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                kernel_matmult, 5, localMemSizeAInBytes, NULL);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                err, </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                error_handler, </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                <span class="stringliteral">&quot;Unable set arg 5 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                kernelName,</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                status, </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="keywordflow">if</span> (kernel_id == 2) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                        status = clSetKernelArg(</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                kernel_matmult, 6, localMemSizeBInBytes, NULL);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                err, </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                error_handler, </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                <span class="stringliteral">&quot;Unable set arg 6 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                kernelName,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                status, </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="comment">/* Arguments only for C=AA^T */</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                status = clSetKernelArg(</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        kernel_matmult, 1, <span class="keyword">sizeof</span>(cl_mem), (<span class="keywordtype">void</span> *) &amp;matrixC_device);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                        err, </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                        status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                        <span class="stringliteral">&quot;Unable set arg 1 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                        kernelName, </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                        status,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                        <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                status = clSetKernelArg(</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                        kernel_matmult, 2, <span class="keyword">sizeof</span>(cl_int2), (<span class="keywordtype">void</span> *) &amp;a_dim);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                        err, </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                        status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                        <span class="stringliteral">&quot;Unable set arg 2 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                        kernelName,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                        status,</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <span class="keywordflow">if</span> (kernel_id == 4) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                        status = clSetKernelArg(</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                kernel_matmult, 3, localMemSizeAInBytes, NULL);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                                err, </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                error_handler, </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                <span class="stringliteral">&quot;Unable set arg 3 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                kernelName, </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                                status,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                        status = clSetKernelArg(</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                kernel_matmult, 4, localMemSizeBInBytes, NULL);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                err, </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                error_handler, </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                <span class="stringliteral">&quot;Unable set arg 4 of &#39;%s&#39; kernel (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                kernelName, </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                status,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">/* ************ */</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="comment">/*  Run kernel! */</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">/* ************ */</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        status = clEnqueueNDRangeKernel(</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                zone-&gt;<a class="code" href="structclu__zone.html#a56783e9302d069f06e18bcfcdd0380fc">queues</a>[0], </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                kernel_matmult, </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                2, </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                NULL, </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                gws, </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                lws, </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                0, </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                NULL, </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                &amp;(events[2]) </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        );</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                err, </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                error_handler, </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <span class="stringliteral">&quot;Error while executing kernel &#39;%s&#39; (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                kernelName,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                status, </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="comment">/* *********************** */</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="comment">/*  Get result from device */</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="comment">/* *********************** */</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        status = clEnqueueReadBuffer(</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                zone-&gt;<a class="code" href="structclu__zone.html#a56783e9302d069f06e18bcfcdd0380fc">queues</a>[0], </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                matrixC_device, </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                CL_TRUE, </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                0, </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                sizeMatrixCInBytes, </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                matrixC_host, </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                0, </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                NULL, </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                &amp;(events[3]) </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        );</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                err, </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                error_handler, </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <span class="stringliteral">&quot;Unable to read matrix C from device (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                status,</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="comment">/* Finish execution. */</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        status = clFinish(zone-&gt;<a class="code" href="structclu__zone.html#a56783e9302d069f06e18bcfcdd0380fc">queues</a>[0]); </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                err, </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                status != <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a>, </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                error_handler, </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                <span class="stringliteral">&quot;Error on clFinish() function (OpenCL error %d: %s).&quot;</span>, </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                status,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a>(status));</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="comment">/* ************************************** */</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="comment">/*  Manage profiling of OpenCL operations */</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="comment">/* ************************************** */</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="comment">/* Stop profiler. */</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <a class="code" href="clprofiler_8c.html#a7785d2882c29b90924130e3c69837d7d">profcl_profile_stop</a>(profile_dev); </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <a class="code" href="clprofiler_8c.html#ae56bd39303113ae30aa5071fa1c2a6c2">profcl_profile_add</a>(</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                profile_dev, <span class="stringliteral">&quot;Transfer matrix A to device&quot;</span>, events[0], &amp;err);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="matmult_8h.html#abd146d2fd1dc4d9a55cb5304590addcd">IS_AAT</a>(kernel_id)) {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <a class="code" href="clprofiler_8c.html#ae56bd39303113ae30aa5071fa1c2a6c2">profcl_profile_add</a>(</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        profile_dev, <span class="stringliteral">&quot;Transfer matrix B to device&quot;</span>, events[1], &amp;err);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <a class="code" href="clprofiler_8c.html#ae56bd39303113ae30aa5071fa1c2a6c2">profcl_profile_add</a>(</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                profile_dev, <span class="stringliteral">&quot;Kernel execution (Matmult)&quot;</span>, events[2], &amp;err);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <a class="code" href="clprofiler_8c.html#ae56bd39303113ae30aa5071fa1c2a6c2">profcl_profile_add</a>(</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                profile_dev, <span class="stringliteral">&quot;Transfer matrix C to host&quot;</span>, events[3], &amp;err);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <a class="code" href="clprofiler_8c.html#a19fc9b6a7600e585a54943d187697c1c">profcl_profile_aggregate</a>(profile_dev, &amp;err);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="comment">/* Show profiling info. */</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <a class="code" href="clprofiler_8c.html#ad0626ca896792759a54295bed08fa87d">profcl_print_info</a>(profile_dev, <a class="code" href="clprofiler_8h.html#a90f18e84e6df75461fa0bbfca8271ac6a73e835e914af1e12944ef79a4c185bdf">PROFCL_AGGEVDATA_SORT_TIME</a>, &amp;err);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="comment">/* Export profiling info if a filename was given. */</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">if</span> (output_export) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <a class="code" href="clprofiler_8c.html#a86997b1b0294b548e91b0c36b0e337dd">profcl_export_info_file</a>(profile_dev, output_export, &amp;err);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="comment">/* ********************************************************* */</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="comment">/* Perform multiplication on the CPU with the help of OpenMP */</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="comment">/* ********************************************************* */</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="comment">/* Allocate memory for a new results matrix. */</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        matrixC_test = <a class="code" href="matmult_8c.html#adee8bac384bb7760949f394ce508f88b">matmult_matrix_new</a>(b_dim[0], a_dim[1], NULL, NULL);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                err, </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                matrixC_test == NULL, </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                error_handler, </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="stringliteral">&quot;Unable to create host matrix C (OpenMP test).&quot;</span>);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="comment">/* Get number of processors available to OpenMP. */</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="comment">/* Start basic timming / profiling. */</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <a class="code" href="clprofiler_8c.html#abd2e222ebad6d1ce9015c820a5b7016d">profcl_profile_start</a>(profile_cpu);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="matmult_8h.html#abd146d2fd1dc4d9a55cb5304590addcd">IS_AAT</a>(kernel_id)) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="comment">/* C=AB */</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <span class="comment">/* The pragma below makes the loop parallel with threads = number of cores */</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="preprocessor">#ifdef CF4OCL_USE_OPENMP                </span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="preprocessor">                #pragma omp parallel for</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; b_dim[0]; col++) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; a_dim[1]; row++) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                matrixC_test[row * b_dim[0] + col] = 0;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; a_dim[0]; i++) {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                        matrixC_test[row * b_dim[0] + col] += </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                                matrixA_host[row * a_dim[0] + i] </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                                * </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                                matrixB_host[i * b_dim[0] + col];</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                        }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="comment">/* C=AA^T */</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <span class="comment">/* The pragma below makes the loop parallel with threads = number of cores */</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor">#ifdef CF4OCL_USE_OPENMP                </span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="preprocessor">                #pragma omp parallel for</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; a_dim[1]; row++) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; a_dim[1]; col++) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                matrixC_test[row * a_dim[1] + col] = 0;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; a_dim[0]; i++) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                        matrixC_test[row * a_dim[1] + col] += </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                                matrixA_host[row * a_dim[0] + i] </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                                * </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                                matrixA_host[col * a_dim[0] + i];</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                        }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                }       </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="comment">/* Get finishing time */</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <a class="code" href="clprofiler_8c.html#a7785d2882c29b90924130e3c69837d7d">profcl_profile_stop</a>(profile_cpu);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="comment">/* ******************************************************** */</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment">/* Determine and print OpenCL/OpenMP comparison information */</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="comment">/* ******************************************************** */</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">/* Check for correctness */</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordtype">int</span> error = 0;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeC = b_dim[0] * a_dim[1];</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = 0; index &lt; sizeC; index++) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                error += matrixC_host[index] - matrixC_test[index];</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        printf(<span class="stringliteral">&quot;\n   ============================== Results ==================================\n\n&quot;</span>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        printf(<span class="stringliteral">&quot;     Total CPU Time %s: %fs\n&quot;</span>, </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;#ifdef CF4OCL_USE_OPENMP        </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <span class="stringliteral">&quot;(Parallel)   &quot;</span>,</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <span class="stringliteral">&quot;(Serial)     &quot;</span>,</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;#endif</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                <a class="code" href="clprofiler_8c.html#a82adb4e9535ffe733b79f48d1d6fbaf8">profcl_time_elapsed</a>(profile_cpu));</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        printf(<span class="stringliteral">&quot;     SpeedUp (OpenCL vs. %s) : %fx\n&quot;</span>,</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;#ifdef CF4OCL_USE_OPENMP        </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <span class="stringliteral">&quot;OpenMP&quot;</span>,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                <span class="stringliteral">&quot;1x CPU&quot;</span>,</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;#endif</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <a class="code" href="clprofiler_8c.html#a82adb4e9535ffe733b79f48d1d6fbaf8">profcl_time_elapsed</a>(profile_cpu) / <a class="code" href="clprofiler_8c.html#a82adb4e9535ffe733b79f48d1d6fbaf8">profcl_time_elapsed</a>(profile_dev));</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        printf(<span class="stringliteral">&quot;     Error (Device-CPU)          : %d\n&quot;</span>, error);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="comment">/* Show matrices messages if verbose == TRUE */</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">if</span> (verbose) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;\n\&quot;Matrix A\&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; a_dim[1]; i++) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; a_dim[0]; j++) {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                                fprintf(stderr, <span class="stringliteral">&quot;%d\t&quot;</span>, matrixA_host[a_dim[0] * i + j]);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="matmult_8h.html#abd146d2fd1dc4d9a55cb5304590addcd">IS_AAT</a>(kernel_id)) {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;\n\&quot;Matrix B\&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; b_dim[1]; i++) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; b_dim[0]; j++) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                        fprintf(stderr, <span class="stringliteral">&quot;%d\t&quot;</span>, matrixB_host[b_dim[0] * i + j]);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                                fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                        }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;\n\&quot;Device matrix C\&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; a_dim[1]; row++) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; b_dim[0]; col++) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                fprintf(stderr, <span class="stringliteral">&quot;%d\t&quot;</span>, matrixC_host[b_dim[0] * row + col]);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                        }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;\n\&quot;CPU matrix C\&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; a_dim[1]; row++) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; b_dim[0]; col++) {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                fprintf(stderr, <span class="stringliteral">&quot;%d\t&quot;</span>, matrixC_test[b_dim[0] * row + col]);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                        }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="comment">/* If we get here, no need for error treatment, jump to cleanup. */</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        g_assert(err == NULL);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        status = <a class="code" href="exp__common_8h.html#a1857bf0dc9ac7054235718cd84b995a5">CLEXP_SUCCESS</a>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;error_handler:</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="comment">/* If we got here there was an error, verify that it is so. */</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        g_assert (err != NULL);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        fprintf(</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                stderr, </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <span class="stringliteral">&quot;Error %d from domain &#39;%s&#39; with message: \&quot;%s\&quot;\n&quot;</span>, </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                err-&gt;code, </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                g_quark_to_string(err-&gt;domain), </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                err-&gt;message);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        g_error_free(err);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        status = <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;cleanup:        </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">/* *********** */</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="comment">/* Free stuff! */</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="comment">/* *********** */</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="comment">/* Free profile and cpu timer */</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">if</span> (profile_dev) <a class="code" href="clprofiler_8c.html#a89938a498a2b614e40fbf14ff5caa8a8">profcl_profile_free</a>(profile_dev);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keywordflow">if</span> (profile_cpu) <a class="code" href="clprofiler_8c.html#a89938a498a2b614e40fbf14ff5caa8a8">profcl_profile_free</a>(profile_cpu);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="comment">/* Free string command line options. */</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordflow">if</span> (compiler_opts) g_free(compiler_opts);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">if</span> (dev_name) g_free(dev_name);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keywordflow">if</span> (dev_vendor) g_free(dev_vendor);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">if</span> (platf_name) g_free(platf_name);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">if</span> (output_export) g_free(output_export);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="comment">/* Free miscelaneous objects. */</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordflow">if</span> (kernelName) g_free(kernelName);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">if</span> (kernelPath) g_free(kernelPath);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="comment">/* Free RNG */</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordflow">if</span> (rng) g_rand_free(rng);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="comment">/* Release events */</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                <span class="keywordflow">if</span> (events[i]) status = clReleaseEvent(events[i]);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="comment">/* Release OpenCL kernels */</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">if</span> (kernel_matmult) clReleaseKernel(kernel_matmult);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="comment">/* Release OpenCL memory objects */</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">if</span> (matrixA_device) clReleaseMemObject(matrixA_device);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">if</span> (matrixB_device) clReleaseMemObject(matrixB_device);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">if</span> (matrixC_device) clReleaseMemObject(matrixC_device);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="comment">/* Free OpenCL zone */</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordflow">if</span> (zone) <a class="code" href="clutils_8c.html#afe1988e28cbafa40c52f7e74f4b8034e">clu_zone_free</a>(zone);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="comment">/* Free host resources */</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordflow">if</span> (matrixA_host) <a class="code" href="matmult_8c.html#a3b00b6a2c992d62a75c0715102de9cca">matmult_matrix_free</a>(matrixA_host);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">if</span> (matrixB_host) <a class="code" href="matmult_8c.html#a3b00b6a2c992d62a75c0715102de9cca">matmult_matrix_free</a>(matrixB_host);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">if</span> (matrixC_host) <a class="code" href="matmult_8c.html#a3b00b6a2c992d62a75c0715102de9cca">matmult_matrix_free</a>(matrixC_host);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">if</span> (matrixC_test) <a class="code" href="matmult_8c.html#a3b00b6a2c992d62a75c0715102de9cca">matmult_matrix_free</a>(matrixC_test);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="comment">/* Return program status. */</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;}</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno"><a class="line" href="matmult_8h.html#adee8bac384bb7760949f394ce508f88b">  911</a></span>&#160;<span class="keywordtype">int</span>* <a class="code" href="matmult_8c.html#adee8bac384bb7760949f394ce508f88b">matmult_matrix_new</a>(<span class="keywordtype">int</span> cols, <span class="keywordtype">int</span> rows, <span class="keywordtype">int</span>* matrix_range, GRand* rng) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordtype">int</span> *matrix = (<span class="keywordtype">int</span>*) malloc(cols * rows * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordflow">if</span> ((matrix != NULL) &amp;&amp; (matrix_range != NULL)) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                g_assert(rng != NULL);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; cols * rows; i++) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        matrix[i] = g_rand_int_range(rng, matrix_range[0], matrix_range[1]);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">return</span> matrix;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;}</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div>
<div class="line"><a name="l00927"></a><span class="lineno"><a class="line" href="matmult_8h.html#a3b00b6a2c992d62a75c0715102de9cca">  927</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="matmult_8c.html#a3b00b6a2c992d62a75c0715102de9cca">matmult_matrix_free</a>(<span class="keywordtype">int</span>* matrix) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        g_assert(matrix != NULL);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        free(matrix);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;}</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div>
<div class="line"><a name="l00940"></a><span class="lineno"><a class="line" href="matmult_8h.html#abdcd498e039367132145f428df93f2eb">  940</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="matmult_8c.html#abdcd498e039367132145f428df93f2eb">matmult_args_parse</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[], GError** err) {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="comment">/* Aux. var. */</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordtype">int</span> status;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="comment">/* Command line options context. */</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        GOptionContext* context = NULL;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="comment">/* Create parsing context. */</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        context = g_option_context_new (<span class="stringliteral">&quot; - &quot;</span> <a class="code" href="matmult_8c.html#a0159a7996b02aca4b98b3bbbca901f88">PROG_DESCRIPTION</a>);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                *err, </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                context == NULL, </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                error_handler, </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                <span class="stringliteral">&quot;Unable to create command line parsing context.&quot;</span>);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="comment">/* Add acceptable command line options to context. */</span> </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        g_option_context_add_main_entries(context, entries, NULL);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="comment">/* Use context to parse command line options. */</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        g_option_context_parse(context, &amp;argc, &amp;argv, err);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <a class="code" href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a>(*err, <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, status, error_handler);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="comment">/* Make checks which depend if the multiplication is AB or AA^T (transpose) */</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="matmult_8h.html#abd146d2fd1dc4d9a55cb5304590addcd">IS_AAT</a>(kernel_id)) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="comment">/* Check if number of rows in B is the same as the number of columns in A. */</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                        *err, </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                        <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                        (b_dim[1] != a_dim[0]), </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                        <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                        <span class="stringliteral">&quot;Number of rows in B must the same as the number of columns in A.&quot;</span>);    </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                <span class="comment">/* In this case (transpose multiplication), dimensions of B are considered to be of dimensions of A^T. */</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                b_dim[0] = a_dim[1];</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                b_dim[1] = a_dim[0];</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="comment">/* Check if kernel ID is within 0 to 4. */</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                *err, </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <a class="code" href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a>, </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                ((kernel_id &lt; 0) || (kernel_id &gt; 4)), </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>, </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                error_handler, </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                <span class="stringliteral">&quot;Kernel selection must be 0, 1, 2 (for C=AB kernels), 3 or 4 (for C=AA^T kernels).&quot;</span>);   </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="comment">/* If we get here, no need for error treatment, jump to cleanup. */</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        g_assert (err == NULL || *err == NULL);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        status = <a class="code" href="exp__common_8h.html#a1857bf0dc9ac7054235718cd84b995a5">CLEXP_SUCCESS</a>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;error_handler:</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="comment">/* If we got here there was an error, verify that it is so. */</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        g_assert (err == NULL || *err != NULL);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        status = <a class="code" href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;cleanup:        </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="comment">/* Free context. */</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">if</span> (context) g_option_context_free(context);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="comment">/* Return function status. */</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div>
<div class="ttc" id="matmult_8c_html_abdcd498e039367132145f428df93f2eb"><div class="ttname"><a href="matmult_8c.html#abdcd498e039367132145f428df93f2eb">matmult_args_parse</a></div><div class="ttdeci">int matmult_args_parse(int argc, char *argv[], GError **err)</div><div class="ttdoc">Parse and verify command line arguments. </div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00940">matmult.c:940</a></div></div>
<div class="ttc" id="clprofiler_8c_html_abd2e222ebad6d1ce9015c820a5b7016d"><div class="ttname"><a href="clprofiler_8c.html#abd2e222ebad6d1ce9015c820a5b7016d">profcl_profile_start</a></div><div class="ttdeci">void profcl_profile_start(ProfCLProfile *profile)</div><div class="ttdoc">Indication that profiling sessions has started. Starts the global profiler timer. ...</div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8c_source.html#l00783">clprofiler.c:783</a></div></div>
<div class="ttc" id="matmult_8c_html_a7efcfabdd53cca51786b2616ec65e598"><div class="ttname"><a href="matmult_8c.html#a7efcfabdd53cca51786b2616ec65e598">RANGE_MATRIX_FROM</a></div><div class="ttdeci">#define RANGE_MATRIX_FROM</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00064">matmult.c:64</a></div></div>
<div class="ttc" id="clprofiler_8c_html_ad0626ca896792759a54295bed08fa87d"><div class="ttname"><a href="clprofiler_8c.html#ad0626ca896792759a54295bed08fa87d">profcl_print_info</a></div><div class="ttdeci">int profcl_print_info(ProfCLProfile *profile, ProfCLEvAggDataSort evAggSortType, GError **err)</div><div class="ttdoc">Print profiling info. </div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8c_source.html#l00828">clprofiler.c:828</a></div></div>
<div class="ttc" id="exp__common_8c_html_a154ee0dfbead43776b8cc5ccecd49917"><div class="ttname"><a href="exp__common_8c.html#a154ee0dfbead43776b8cc5ccecd49917">clexp_kernelpath_get</a></div><div class="ttdeci">gchar * clexp_kernelpath_get(gchar *kernel_filename, char *exec_name)</div><div class="ttdoc">Get full kernel path name. </div><div class="ttdef"><b>Definition:</b> <a href="exp__common_8c_source.html#l00057">exp_common.c:57</a></div></div>
<div class="ttc" id="structclu__zone_html_a56783e9302d069f06e18bcfcdd0380fc"><div class="ttname"><a href="structclu__zone.html#a56783e9302d069f06e18bcfcdd0380fc">clu_zone::queues</a></div><div class="ttdeci">cl_command_queue * queues</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00137">clutils.h:137</a></div></div>
<div class="ttc" id="matmult_8h_html"><div class="ttname"><a href="matmult_8h.html">matmult.h</a></div><div class="ttdoc">Matrix multiplication examples: common headers and definitions. </div></div>
<div class="ttc" id="exp__common_8h_html_a18d295a837ac71add5578860b55e5502"><div class="ttname"><a href="exp__common_8h.html#a18d295a837ac71add5578860b55e5502">STR</a></div><div class="ttdeci">#define STR(x)</div><div class="ttdef"><b>Definition:</b> <a href="exp__common_8h_source.html#l00042">exp_common.h:42</a></div></div>
<div class="ttc" id="matmult_8c_html_aa6c7005b99ec05adc2cfac1060e1e644"><div class="ttname"><a href="matmult_8c.html#aa6c7005b99ec05adc2cfac1060e1e644">B_COLS</a></div><div class="ttdeci">#define B_COLS</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00054">matmult.c:54</a></div></div>
<div class="ttc" id="clutils_8c_html_a321d53c508616c0e432488bcdb78b6cf"><div class="ttname"><a href="clutils_8c.html#a321d53c508616c0e432488bcdb78b6cf">clu_program_create</a></div><div class="ttdeci">int clu_program_create(CLUZone *zone, char **kernelFiles, cl_uint numKernelFiles, char *compilerOpts, GError **err)</div><div class="ttdoc">Create an OpenCL program given a set of source kernel files. </div><div class="ttdef"><b>Definition:</b> <a href="clutils_8c_source.html#l00579">clutils.c:579</a></div></div>
<div class="ttc" id="clutils_8c_html_af96c5c98deef8a8cdde6f7efbc610767"><div class="ttname"><a href="clutils_8c.html#af96c5c98deef8a8cdde6f7efbc610767">clu_menu_device_selector</a></div><div class="ttdeci">cl_uint clu_menu_device_selector(CLUDeviceInfo *devInfos, cl_uint numDevices, void *extraArg)</div><div class="ttdoc">Implementation of clu_device_selector function which queries the user in order to select a device...</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8c_source.html#l00826">clutils.c:826</a></div></div>
<div class="ttc" id="clutils_8c_html_a6ff17fcd1045d12e94f023ac8af1a406"><div class="ttname"><a href="clutils_8c.html#a6ff17fcd1045d12e94f023ac8af1a406">clu_info_device_selector</a></div><div class="ttdeci">cl_uint clu_info_device_selector(CLUDeviceInfo *devInfos, cl_uint numDevices, void *extraArg)</div><div class="ttdoc">Implementation of clu_device_selector function which selects a device based on device information suc...</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8c_source.html#l00875">clutils.c:875</a></div></div>
<div class="ttc" id="clutils_8c_html_aafef46ba2df88c456ba056b4806ef51e"><div class="ttname"><a href="clutils_8c.html#aafef46ba2df88c456ba056b4806ef51e">clu_zone_new</a></div><div class="ttdeci">CLUZone * clu_zone_new(cl_uint deviceType, cl_uint numQueues, cl_int queueProperties, clu_device_selector devSel, void *dsExtraArg, GError **err)</div><div class="ttdoc">Create a new OpenCL zone, which will contain complete information for an OpenCL execution session on ...</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8c_source.html#l00301">clutils.c:301</a></div></div>
<div class="ttc" id="clprofiler_8c_html_a89938a498a2b614e40fbf14ff5caa8a8"><div class="ttname"><a href="clprofiler_8c.html#a89938a498a2b614e40fbf14ff5caa8a8">profcl_profile_free</a></div><div class="ttdeci">void profcl_profile_free(ProfCLProfile *profile)</div><div class="ttdoc">Free an OpenCL events profile. </div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8c_source.html#l00091">clprofiler.c:91</a></div></div>
<div class="ttc" id="clprofiler_8c_html_ae56bd39303113ae30aa5071fa1c2a6c2"><div class="ttname"><a href="clprofiler_8c.html#ae56bd39303113ae30aa5071fa1c2a6c2">profcl_profile_add</a></div><div class="ttdeci">int profcl_profile_add(ProfCLProfile *profile, const char *event_name, cl_event ev, GError **err)</div><div class="ttdoc">Add OpenCL event to events profile, more specifically adds the start and end instants of the given ev...</div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8c_source.html#l00124">clprofiler.c:124</a></div></div>
<div class="ttc" id="matmult_8c_html_a9ad4d76b2a845d89ee2ce6198fb488d8"><div class="ttname"><a href="matmult_8c.html#a9ad4d76b2a845d89ee2ce6198fb488d8">B_ROWS</a></div><div class="ttdeci">#define B_ROWS</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00056">matmult.c:56</a></div></div>
<div class="ttc" id="structprofcl__profile_html"><div class="ttname"><a href="structprofcl__profile.html">profcl_profile</a></div><div class="ttdoc">Contains the profiling info of an OpenCL application. </div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8h_source.html#l00064">clprofiler.h:64</a></div></div>
<div class="ttc" id="structclu__device__info_html"><div class="ttname"><a href="structclu__device__info.html">clu_device_info</a></div><div class="ttdoc">Information about OpenCL device. </div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00122">clutils.h:122</a></div></div>
<div class="ttc" id="matmult_8c_html_adee8bac384bb7760949f394ce508f88b"><div class="ttname"><a href="matmult_8c.html#adee8bac384bb7760949f394ce508f88b">matmult_matrix_new</a></div><div class="ttdeci">int * matmult_matrix_new(int cols, int rows, int *matrix_range, GRand *rng)</div><div class="ttdoc">Create a new matrix with random values. </div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00911">matmult.c:911</a></div></div>
<div class="ttc" id="exp__common_8h_html_a1857bf0dc9ac7054235718cd84b995a5"><div class="ttname"><a href="exp__common_8h.html#a1857bf0dc9ac7054235718cd84b995a5">CLEXP_SUCCESS</a></div><div class="ttdeci">#define CLEXP_SUCCESS</div><div class="ttdoc">Code for operation successful. </div><div class="ttdef"><b>Definition:</b> <a href="exp__common_8h_source.html#l00068">exp_common.h:68</a></div></div>
<div class="ttc" id="exp__common_8h_html_ab10604e3bc9e1b49bbf831eb4bab6910"><div class="ttname"><a href="exp__common_8h.html#ab10604e3bc9e1b49bbf831eb4bab6910">clexp_parse_pairs</a></div><div class="ttdeci">#define clexp_parse_pairs(in, out, option_name, data, err)</div><div class="ttdoc">Parse a pair of positive integers from a string separated by a comma. </div><div class="ttdef"><b>Definition:</b> <a href="exp__common_8h_source.html#l00054">exp_common.h:54</a></div></div>
<div class="ttc" id="matmult_8c_html_a42f8c497a1968074f38bf5055c650dca"><div class="ttname"><a href="matmult_8c.html#a42f8c497a1968074f38bf5055c650dca">VERBOSE</a></div><div class="ttdeci">#define VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00073">matmult.c:73</a></div></div>
<div class="ttc" id="structclu__device__info_html_a4731711f2f64ffd4f71f81024087b719"><div class="ttname"><a href="structclu__device__info.html#a4731711f2f64ffd4f71f81024087b719">clu_device_info::device_vendor</a></div><div class="ttdeci">char device_vendor[CLU_MAX_AUX_BUFF]</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00126">clutils.h:126</a></div></div>
<div class="ttc" id="test__profiler_8h_html_acb66e7b68fd648501579ef19dc41265a"><div class="ttname"><a href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a">cl_int</a></div><div class="ttdeci">int cl_int</div><div class="ttdoc">Replaces OpenCL cl_int type. </div><div class="ttdef"><b>Definition:</b> <a href="test__profiler_8h_source.html#l00039">test_profiler.h:39</a></div></div>
<div class="ttc" id="structclu__zone_html_a4406e6a8de34678827c0891ef4a3e4db"><div class="ttname"><a href="structclu__zone.html#a4406e6a8de34678827c0891ef4a3e4db">clu_zone::device_info</a></div><div class="ttdeci">CLUDeviceInfo device_info</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00140">clutils.h:140</a></div></div>
<div class="ttc" id="gerrorf_8h_html_abdf75fa50067bf84ba1274d7ade17c5a"><div class="ttname"><a href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a">gef_if_error_create_goto</a></div><div class="ttdeci">#define gef_if_error_create_goto(err, quark, error_condition, error_code, label, msg,...)</div><div class="ttdoc">If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...</div><div class="ttdef"><b>Definition:</b> <a href="gerrorf_8h_source.html#l00054">gerrorf.h:54</a></div></div>
<div class="ttc" id="structcl_event_html"><div class="ttname"><a href="structcl_event.html">clEvent</a></div><div class="ttdoc">Stub for cl_event objects. </div><div class="ttdef"><b>Definition:</b> <a href="test__profiler_8h_source.html#l00048">test_profiler.h:48</a></div></div>
<div class="ttc" id="clprofiler_8c_html_a82adb4e9535ffe733b79f48d1d6fbaf8"><div class="ttname"><a href="clprofiler_8c.html#a82adb4e9535ffe733b79f48d1d6fbaf8">profcl_time_elapsed</a></div><div class="ttdeci">gdouble profcl_time_elapsed(ProfCLProfile *profile)</div><div class="ttdoc">If profiling has started but not stopped, returns the time since the profiling started. If profiling has been stopped, returns the elapsed time between the time it started and the time it stopped. </div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8c_source.html#l00811">clprofiler.c:811</a></div></div>
<div class="ttc" id="structclu__device__info_html_a177c7a0eb96a3bc2416f3b09a881eb97"><div class="ttname"><a href="structclu__device__info.html#a177c7a0eb96a3bc2416f3b09a881eb97">clu_device_info::device_name</a></div><div class="ttdeci">char device_name[CLU_MAX_AUX_BUFF]</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00125">clutils.h:125</a></div></div>
<div class="ttc" id="exp__common_8h_html_ad2c04333f98771ea231075ba65b603bf"><div class="ttname"><a href="exp__common_8h.html#ad2c04333f98771ea231075ba65b603bf">CLEXP_FAIL</a></div><div class="ttdeci">#define CLEXP_FAIL</div><div class="ttdoc">Code for operation failed. </div><div class="ttdef"><b>Definition:</b> <a href="exp__common_8h_source.html#l00070">exp_common.h:70</a></div></div>
<div class="ttc" id="clerrors_8c_html_aa4b9b02b920eb270989434ab3b4d468d"><div class="ttname"><a href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d">clerror_get</a></div><div class="ttdeci">const char * clerror_get(int code)</div><div class="ttdoc">Convert OpenCL error code to a readable string. </div><div class="ttdef"><b>Definition:</b> <a href="clerrors_8c_source.html#l00108">clerrors.c:108</a></div></div>
<div class="ttc" id="group___c_l_u___m_a_x_html_gac3230980b5f2628f08ee53c8f45726a0"><div class="ttname"><a href="group___c_l_u___m_a_x.html#gac3230980b5f2628f08ee53c8f45726a0">CLU_MAX_AUX_BUFF</a></div><div class="ttdeci">#define CLU_MAX_AUX_BUFF</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00082">clutils.h:82</a></div></div>
<div class="ttc" id="matmult_8c_html_a769c881bc0b0d7b78ec45b52ed7133ae"><div class="ttname"><a href="matmult_8c.html#a769c881bc0b0d7b78ec45b52ed7133ae">LWS_X</a></div><div class="ttdeci">#define LWS_X</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00059">matmult.c:59</a></div></div>
<div class="ttc" id="matmult_8c_html_ab53adb106bfbfc72bc0918855fccdb18"><div class="ttname"><a href="matmult_8c.html#ab53adb106bfbfc72bc0918855fccdb18">KERNEL_ID</a></div><div class="ttdeci">#define KERNEL_ID</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00070">matmult.c:70</a></div></div>
<div class="ttc" id="clutils_8c_html_afe1988e28cbafa40c52f7e74f4b8034e"><div class="ttname"><a href="clutils_8c.html#afe1988e28cbafa40c52f7e74f4b8034e">clu_zone_free</a></div><div class="ttdeci">void clu_zone_free(CLUZone *zone)</div><div class="ttdoc">Free a previously created OpenCL zone. </div><div class="ttdef"><b>Definition:</b> <a href="clutils_8c_source.html#l00728">clutils.c:728</a></div></div>
<div class="ttc" id="structclu__zone_html_a7afda8b03e51380bc7cdb908a95ae73a"><div class="ttname"><a href="structclu__zone.html#a7afda8b03e51380bc7cdb908a95ae73a">clu_zone::context</a></div><div class="ttdeci">cl_context context</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00136">clutils.h:136</a></div></div>
<div class="ttc" id="matmult_8h_html_abd146d2fd1dc4d9a55cb5304590addcd"><div class="ttname"><a href="matmult_8h.html#abd146d2fd1dc4d9a55cb5304590addcd">IS_AAT</a></div><div class="ttdeci">#define IS_AAT(kid)</div><div class="ttdoc">Check if the multiplication is  (matrix A and its transpose). </div><div class="ttdef"><b>Definition:</b> <a href="matmult_8h_source.html#l00044">matmult.h:44</a></div></div>
<div class="ttc" id="matmult_8c_html_a0159a7996b02aca4b98b3bbbca901f88"><div class="ttname"><a href="matmult_8c.html#a0159a7996b02aca4b98b3bbbca901f88">PROG_DESCRIPTION</a></div><div class="ttdeci">#define PROG_DESCRIPTION</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00079">matmult.c:79</a></div></div>
<div class="ttc" id="clprofiler_8c_html_a19fc9b6a7600e585a54943d187697c1c"><div class="ttname"><a href="clprofiler_8c.html#a19fc9b6a7600e585a54943d187697c1c">profcl_profile_aggregate</a></div><div class="ttdeci">int profcl_profile_aggregate(ProfCLProfile *profile, GError **err)</div><div class="ttdoc">Determine aggregate statistics for the given OpenCL events profile. </div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8c_source.html#l00633">clprofiler.c:633</a></div></div>
<div class="ttc" id="clprofiler_8c_html_a86997b1b0294b548e91b0c36b0e337dd"><div class="ttname"><a href="clprofiler_8c.html#a86997b1b0294b548e91b0c36b0e337dd">profcl_export_info_file</a></div><div class="ttdeci">int profcl_export_info_file(ProfCLProfile *profile, const char *filename, GError **err)</div><div class="ttdoc">Helper function which exports profiling info to a given file, automatically opening and closing the f...</div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8c_source.html#l01117">clprofiler.c:1117</a></div></div>
<div class="ttc" id="clprofiler_8c_html_a7785d2882c29b90924130e3c69837d7d"><div class="ttname"><a href="clprofiler_8c.html#a7785d2882c29b90924130e3c69837d7d">profcl_profile_stop</a></div><div class="ttdeci">void profcl_profile_stop(ProfCLProfile *profile)</div><div class="ttdoc">Indication that profiling sessions has ended. Stops the global profiler timer. </div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8c_source.html#l00796">clprofiler.c:796</a></div></div>
<div class="ttc" id="matmult_8c_html_a3846838d5614130293f878591d9417c7"><div class="ttname"><a href="matmult_8c.html#a3846838d5614130293f878591d9417c7">A_ROWS</a></div><div class="ttdeci">#define A_ROWS</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00052">matmult.c:52</a></div></div>
<div class="ttc" id="matmult_8c_html_a3b00b6a2c992d62a75c0715102de9cca"><div class="ttname"><a href="matmult_8c.html#a3b00b6a2c992d62a75c0715102de9cca">matmult_matrix_free</a></div><div class="ttdeci">void matmult_matrix_free(int *matrix)</div><div class="ttdoc">Free&#39;s a matrix created with matmult_matrix_new(). </div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00927">matmult.c:927</a></div></div>
<div class="ttc" id="clprofiler_8c_html_ab1b31625c65ec819cf1e092da13c9cc0"><div class="ttname"><a href="clprofiler_8c.html#ab1b31625c65ec819cf1e092da13c9cc0">profcl_profile_new</a></div><div class="ttdeci">ProfCLProfile * profcl_profile_new()</div><div class="ttdoc">Create a new OpenCL events profile. </div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8c_source.html#l00045">clprofiler.c:45</a></div></div>
<div class="ttc" id="gerrorf_8h_html_a89166945e6ef4f6792897f0955c26b0d"><div class="ttname"><a href="gerrorf_8h.html#a89166945e6ef4f6792897f0955c26b0d">gef_if_error_goto</a></div><div class="ttdeci">#define gef_if_error_goto(err, error_code, status, label)</div><div class="ttdoc">If error is detected in err object (err != NULL), set status to specified error_code OR to error code...</div><div class="ttdef"><b>Definition:</b> <a href="gerrorf_8h_source.html#l00075">gerrorf.h:75</a></div></div>
<div class="ttc" id="structclu__zone_html_a22ecfe977ebfe190a5da0a060d5fc4ef"><div class="ttname"><a href="structclu__zone.html#a22ecfe977ebfe190a5da0a060d5fc4ef">clu_zone::program</a></div><div class="ttdeci">cl_program program</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00138">clutils.h:138</a></div></div>
<div class="ttc" id="matmult_8c_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="matmult_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdoc">OpenCL and OpenMP matrix multiplication main function. </div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00139">matmult.c:139</a></div></div>
<div class="ttc" id="structclu__zone_html"><div class="ttname"><a href="structclu__zone.html">clu_zone</a></div><div class="ttdoc">Complete information for an OpenCL execution session on a specific device. </div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00133">clutils.h:133</a></div></div>
<div class="ttc" id="matmult_8c_html_ad350bae49f72ba58d73027f1316e38b8"><div class="ttname"><a href="matmult_8c.html#ad350bae49f72ba58d73027f1316e38b8">SEED</a></div><div class="ttdeci">#define SEED</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00076">matmult.c:76</a></div></div>
<div class="ttc" id="exp__common_8h_html_a2a9f64a1b8a6180245e07786bd3c020c"><div class="ttname"><a href="exp__common_8h.html#a2a9f64a1b8a6180245e07786bd3c020c">CLEXP_ERROR</a></div><div class="ttdeci">#define CLEXP_ERROR</div><div class="ttdoc">Resolves to error category identifying string. Required by glib error reporting system. </div><div class="ttdef"><b>Definition:</b> <a href="exp__common_8h_source.html#l00079">exp_common.h:79</a></div></div>
<div class="ttc" id="matmult_8c_html_a9ca5c73118893390a779a2342c29da3a"><div class="ttname"><a href="matmult_8c.html#a9ca5c73118893390a779a2342c29da3a">RANGE_MATRIX_TO</a></div><div class="ttdeci">#define RANGE_MATRIX_TO</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00067">matmult.c:67</a></div></div>
<div class="ttc" id="test__profiler_8h_html_a945238394cd7f518e7196ec80ea74594"><div class="ttname"><a href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594">CL_SUCCESS</a></div><div class="ttdeci">#define CL_SUCCESS</div><div class="ttdoc">OpenCL success code. </div><div class="ttdef"><b>Definition:</b> <a href="test__profiler_8h_source.html#l00033">test_profiler.h:33</a></div></div>
<div class="ttc" id="exp__common_8c_html_a425368c6a70a29de8cdfac4fd8737160"><div class="ttname"><a href="exp__common_8c.html#a425368c6a70a29de8cdfac4fd8737160">clexp_reqs_print</a></div><div class="ttdeci">void clexp_reqs_print(size_t *gws, size_t *lws, size_t gmem, size_t lmem)</div><div class="ttdoc">Print device requirements for program. </div><div class="ttdef"><b>Definition:</b> <a href="exp__common_8c_source.html#l00037">exp_common.c:37</a></div></div>
<div class="ttc" id="clprofiler_8h_html_a90f18e84e6df75461fa0bbfca8271ac6a73e835e914af1e12944ef79a4c185bdf"><div class="ttname"><a href="clprofiler_8h.html#a90f18e84e6df75461fa0bbfca8271ac6a73e835e914af1e12944ef79a4c185bdf">PROFCL_AGGEVDATA_SORT_TIME</a></div><div class="ttdef"><b>Definition:</b> <a href="clprofiler_8h_source.html#l00098">clprofiler.h:98</a></div></div>
<div class="ttc" id="matmult_8c_html_a1579df3a428a5aff80e5a1e0cfa2f713"><div class="ttname"><a href="matmult_8c.html#a1579df3a428a5aff80e5a1e0cfa2f713">A_COLS</a></div><div class="ttdeci">#define A_COLS</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00050">matmult.c:50</a></div></div>
<div class="ttc" id="matmult_8c_html_af9a15eccf5ca0133aa49ae35bc2e2f10"><div class="ttname"><a href="matmult_8c.html#af9a15eccf5ca0133aa49ae35bc2e2f10">LWS_Y</a></div><div class="ttdeci">#define LWS_Y</div><div class="ttdef"><b>Definition:</b> <a href="matmult_8c_source.html#l00061">matmult.c:61</a></div></div>
<div class="ttc" id="structclu__device__info_html_a8d5741b6e1df3ba5b9b37d214d5d9720"><div class="ttname"><a href="structclu__device__info.html#a8d5741b6e1df3ba5b9b37d214d5d9720">clu_device_info::platform_name</a></div><div class="ttdeci">char platform_name[CLU_MAX_AUX_BUFF]</div><div class="ttdef"><b>Definition:</b> <a href="clutils_8h_source.html#l00127">clutils.h:127</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 4 2014 16:52:02 for cf4ocl (C Framework for OpenCL) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
